// /root/.xbmc/addons/service.downloadmanager.InternetPVR/CouchPotatoServer/couchpotato/core/_base/updater/static/updater.js:1401248965
var UpdaterBase=new Class({Implements:[Events],initialize:function(){var self=this;App.addEvent('load',self.info.bind(self,2000))
App.addEvent('unload',function(){if(self.timer)
clearTimeout(self.timer);});},check:function(onComplete){var self=this;Api.request('updater.check',{'onComplete':function(json){if(onComplete)
onComplete(json);if(json.update_available)
self.doUpdate();else{App.unBlockPage();App.trigger('message',['No updates available']);}}})},info:function(timeout){var self=this;if(self.timer)clearTimeout(self.timer);self.timer=setTimeout(function(){Api.request('updater.info',{'onComplete':function(json){self.json=json;self.fireEvent('loaded',[json]);if(json.update_version){self.createMessage(json);}
else{if(self.message)
self.message.destroy();}}})},(timeout||0))},getInfo:function(){return this.json;},createMessage:function(data){var self=this;if(self.message)return;var changelog='https://github.com/'+data.repo_name+'/compare/'+data.version.hash+'...'+data.branch;if(data.update_version.changelog)
changelog=data.update_version.changelog+'#'+data.version.hash+'...'+data.update_version.hash
self.message=new Element('div.message.update').adopt(new Element('span',{'text':'A new version is available'}),new Element('a',{'href':changelog,'text':'see what has changed','target':'_blank'}),new Element('span[text=or]'),new Element('a',{'text':'just update, gogogo!','events':{'click':self.doUpdate.bind(self)}})).inject(document.body)},doUpdate:function(){var self=this;App.blockPage('Please wait while CouchPotato is being updated with more awesome stuff.','Updating');Api.request('updater.update',{'onComplete':function(json){if(json.success)
self.updating();else
App.unBlockPage()}});},updating:function(){App.checkAvailable.delay(500,App,[1000,function(){window.location.reload();}]);if(self.message)
self.message.destroy();}});var Updater=new UpdaterBase();

// /root/.xbmc/addons/service.downloadmanager.InternetPVR/CouchPotatoServer/couchpotato/core/plugins/category/static/category.js:1401248968
var CategoryListBase=new Class({initialize:function(){var self=this;App.addEvent('load',self.addSettings.bind(self));},setup:function(categories){var self=this;self.categories=[]
Array.each(categories,self.createCategory.bind(self));},addSettings:function(){var self=this;self.settings=App.getPage('Settings')
self.settings.addEvent('create',function(){var tab=self.settings.createSubTab('category',{'label':'Categories','name':'category','subtab_label':'Category & filtering'},self.settings.tabs.searcher,'searcher');self.tab=tab.tab;self.content=tab.content;self.createList();self.createOrdering();})
self.settings.addEvent('create',function(){var renamer_group=self.settings.tabs.renamer.groups.renamer;self.categories.each(function(category){var input=new Option.Directory('section_name','option.name',category.get('destination'),{'name':category.get('label')});input.inject(renamer_group.getElement('.renamer_to'));input.fireEvent('injected');input.save=function(){category.data.destination=input.getValue();category.save();};});})},createList:function(){var self=this;var count=self.categories.length;self.settings.createGroup({'label':'Categories','description':'Create categories, each one extending global filters. (Needs refresh \''+(App.isMac()?'CMD+R':'F5')+'\' after editing)'}).inject(self.content).adopt(self.category_container=new Element('div.container'),new Element('a.add_new_category',{'text':count>0?'Create another category':'Click here to create a category.','events':{'click':function(){var category=self.createCategory();$(category).inject(self.category_container)}}}));Array.each(self.categories,function(category){$(category).inject(self.category_container)});},getCategory:function(id){return this.categories.filter(function(category){return category.data.id==id}).pick()},getAll:function(){return this.categories;},createCategory:function(data){var self=this;var data=data||{'id':randomString()}
var category=new Category(data)
self.categories.include(category)
return category;},createOrdering:function(){var self=this;var category_list;var group=self.settings.createGroup({'label':'Category ordering'}).adopt(new Element('.ctrlHolder#category_ordering').adopt(new Element('label[text=Order]'),category_list=new Element('ul'),new Element('p.formHint',{'html':'Change the order the categories are in the dropdown list.<br />First one will be default.'}))).inject(self.content)
Array.each(self.categories,function(category){new Element('li',{'data-id':category.data.id}).adopt(new Element('span.category_label',{'text':category.data.label}),new Element('span.handle')).inject(category_list);});self.category_sortable=new Sortables(category_list,{'revert':true,'handle':'','opacity':0.5,'onComplete':self.saveOrdering.bind(self)});},saveOrdering:function(){var self=this;var ids=[];self.category_sortable.list.getElements('li').each(function(el,nr){ids.include(el.get('data-id'));});Api.request('category.save_order',{'data':{'ids':ids}});}})
window.CategoryList=new CategoryListBase();var Category=new Class({data:{},initialize:function(data){var self=this;self.data=data;self.create();self.el.addEvents({'change:relay(select)':self.save.bind(self,0),'keyup:relay(input[type=text])':self.save.bind(self,[300])});},create:function(){var self=this;var data=self.data;self.el=new Element('div.category').adopt(self.delete_button=new Element('span.delete.icon2',{'events':{'click':self.del.bind(self)}}),new Element('.category_label.ctrlHolder').adopt(new Element('label',{'text':'Name'}),new Element('input.inlay',{'type':'text','value':data.label,'placeholder':'Example: Kids, Horror or His'}),new Element('p.formHint',{'text':'See global filters for explanation.'})),new Element('.category_preferred.ctrlHolder').adopt(new Element('label',{'text':'Preferred'}),new Element('input.inlay',{'type':'text','value':data.preferred,'placeholder':'Blu-ray, DTS'})),new Element('.category_required.ctrlHolder').adopt(new Element('label',{'text':'Required'}),new Element('input.inlay',{'type':'text','value':data.required,'placeholder':'Example: DTS, AC3 & English'})),new Element('.category_ignored.ctrlHolder').adopt(new Element('label',{'text':'Ignored'}),new Element('input.inlay',{'type':'text','value':data.ignored,'placeholder':'Example: dubbed, swesub, french'})));self.makeSortable()},save:function(delay){var self=this;if(self.save_timer)clearTimeout(self.save_timer);self.save_timer=(function(){var data=self.getData();Api.request('category.save',{'data':self.getData(),'useSpinner':true,'spinnerOptions':{'target':self.el},'onComplete':function(json){if(json.success){self.data=json.category;}}});}).delay(delay||0,self)},getData:function(){var self=this;var data={'id':self.data.id,'label':self.el.getElement('.category_label input').get('value'),'required':self.el.getElement('.category_required input').get('value'),'preferred':self.el.getElement('.category_preferred input').get('value'),'ignored':self.el.getElement('.category_ignored input').get('value'),'destination':self.data.destination}
return data},del:function(){var self=this;if(self.data.label==undefined){self.el.destroy();return;}
var label=self.el.getElement('.category_label input').get('value');var qObj=new Question('Are you sure you want to delete <strong>"'+label+'"</strong>?','',[{'text':'Delete "'+label+'"','class':'delete','events':{'click':function(e){(e).preventDefault();Api.request('category.delete',{'data':{'id':self.data.id},'useSpinner':true,'spinnerOptions':{'target':self.el},'onComplete':function(json){if(json.success){qObj.close();self.el.destroy();}else{alert(json.message);}}});}}},{'text':'Cancel','cancel':true}]);},makeSortable:function(){var self=this;self.sortable=new Sortables(self.category_container,{'revert':true,'handle':'.handle','opacity':0.5,'onComplete':self.save.bind(self,300)});},get:function(attr){return this.data[attr]},toElement:function(){return this.el}});

// /root/.xbmc/addons/service.downloadmanager.InternetPVR/CouchPotatoServer/couchpotato/core/plugins/file/static/file.js:1401248968
var File=new Class({initialize:function(type,file){var self=this;if(!file){self.empty=true;self.el=new Element('div.empty_file.'+type);return}
self.data=file;self.type=File.Type.get(file.type_id);self['create'+(self.type.type).capitalize()]()},createImage:function(){var self=this;var file_name=self.data.path.replace(/^.*[\\\/]/,'');self.el=new Element('div',{'class':'type_image '+self.type.identifier,'styles':{'background-image':'url('+Api.createUrl('file.cache')+file_name+')'}}).adopt(new Element('img',{'src':Api.createUrl('file.cache')+file_name}))},toElement:function(){return this.el;}});var FileSelect=new Class({multiple:function(type,files,single){var results=files.filter(function(file){return file.type_id==File.Type.get(type).id;});if(single)
return new File(type,results.pop());return results;},single:function(type,files){return this.multiple(type,files,true);}});window.File.Select=new FileSelect();var FileTypeBase=new Class({setup:function(types){var self=this;self.typesById={};self.typesByKey={};Object.each(types,function(type){self.typesByKey[type.identifier]=type;self.typesById[type.id]=type;});},get:function(identifier){if(typeOf(identifier)=='number')
return this.typesById[identifier]
else
return this.typesByKey[identifier]}});window.File.Type=new FileTypeBase();

// /root/.xbmc/addons/service.downloadmanager.InternetPVR/CouchPotatoServer/couchpotato/core/plugins/log/static/log.js:1401248968
Page.Log=new Class({Extends:PageBase,name:'log',title:'Show recent logs.',has_tab:false,indexAction:function(){var self=this;self.getLogs(0);},getLogs:function(nr){var self=this;if(self.log)self.log.destroy();self.log=new Element('div.container.loading',{'text':'loading...'}).inject(self.el);Api.request('logging.get',{'data':{'nr':nr},'onComplete':function(json){self.log.set('html',self.addColors(json.log));self.log.removeClass('loading');new Fx.Scroll(window,{'duration':0}).toBottom();var nav=new Element('ul.nav').inject(self.log,'top');for(var i=0;i<=json.total;i++){new Element('li',{'text':i+1,'class':nr==i?'active':'','events':{'click':function(e){self.getLogs(e.target.get('text')-1);}}}).inject(nav);};new Element('li',{'text':'clear','events':{'click':function(){Api.request('logging.clear',{'onComplete':function(){self.getLogs(0);}});}}}).inject(nav)}});},addColors:function(text){var self=this;text=text.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/\u001b\[31m/gi,'</span><span class="error">').replace(/\u001b\[36m/gi,'</span><span class="debug">').replace(/\u001b\[33m/gi,'</span><span class="debug">').replace(/\u001b\[0m\n/gi,'</span></div><div><span class="time">').replace(/\u001b\[0m/gi,'</span><span>')
return'<div><span class="time">'+text+'</span></div>';}})

// /root/.xbmc/addons/service.downloadmanager.InternetPVR/CouchPotatoServer/couchpotato/core/plugins/profile/static/profile.js:1401248968
var Profile=new Class({data:{},types:[],initialize:function(data){var self=this;self.data=data;self.types=[];self.create();self.el.addEvents({'change:relay(select, input[type=checkbox])':self.save.bind(self,0),'keyup:relay(input[type=text])':self.save.bind(self,[300])});},create:function(){var self=this;var data=self.data;self.el=new Element('div.profile').adopt(self.delete_button=new Element('span.delete.icon2',{'events':{'click':self.del.bind(self)}}),new Element('.quality_label.ctrlHolder').adopt(new Element('label',{'text':'Name'}),new Element('input.inlay',{'type':'text','value':data.label,'placeholder':'Profile name'})),new Element('div.wait_for.ctrlHolder').adopt(new Element('span',{'text':'Wait'}),new Element('input.inlay.xsmall',{'type':'text','value':data.types&&data.types.length>0?data.types[0].wait_for:0}),new Element('span',{'text':'day(s) for a better quality.'})),new Element('div.qualities.ctrlHolder').adopt(new Element('label',{'text':'Search for'}),self.type_container=new Element('ol.types'),new Element('div.formHint',{'html':"Search these qualities (2 minimum), from top to bottom. Use the checkbox, to stop searching after it found this quality."})));self.makeSortable()
if(data.types)
Object.each(data.types,self.addType.bind(self))
else
self.delete_button.hide();self.addType();},save:function(delay){var self=this;if(self.save_timer)clearTimeout(self.save_timer);self.save_timer=(function(){self.addType();var data=self.getData();if(data.types.length<2)
return;else
self.delete_button.show();Api.request('profile.save',{'data':self.getData(),'useSpinner':true,'spinnerOptions':{'target':self.el},'onComplete':function(json){if(json.success){self.data=json.profile;self.type_container.getElement('li:first-child input[type=checkbox]').set('checked',true).getParent().addClass('checked');}}});}).delay(delay,self)},getData:function(){var self=this;var data={'id':self.data.id,'label':self.el.getElement('.quality_label input').get('value'),'wait_for':self.el.getElement('.wait_for input').get('value'),'types':[]}
Array.each(self.type_container.getElements('.type'),function(type){if(!type.hasClass('deleted')&&type.getElement('select').get('value')>0)
data.types.include({'quality_id':type.getElement('select').get('value'),'finish':+type.getElement('input[type=checkbox]').checked});})
return data},addType:function(data){var self=this;var has_empty=false;self.types.each(function(type){if($(type).hasClass('is_empty'))
has_empty=true;});if(has_empty)return;var t=new Profile.Type(data,{'onChange':self.save.bind(self,0)});$(t).inject(self.type_container);self.sortable.addItems($(t));self.types.include(t);},getTypes:function(){var self=this;return self.types.filter(function(type){return type.get('quality_id')});},del:function(){var self=this;var label=self.el.getElement('.quality_label input').get('value');var qObj=new Question('Are you sure you want to delete <strong>"'+label+'"</strong>?','Items using this profile, will be set to the default quality.',[{'text':'Delete "'+label+'"','class':'delete','events':{'click':function(e){(e).preventDefault();Api.request('profile.delete',{'data':{'id':self.data.id},'useSpinner':true,'spinnerOptions':{'target':self.el},'onComplete':function(json){if(json.success){qObj.close();self.el.destroy();}else{alert(json.message);}}});}}},{'text':'Cancel','cancel':true}]);},makeSortable:function(){var self=this;self.sortable=new Sortables(self.type_container,{'revert':true,'handle':'.handle','opacity':0.5,'onComplete':self.save.bind(self,300)});},get:function(attr){return this.data[attr]},isCore:function(){return this.data.core},toElement:function(){return this.el}});Profile.Type=new Class({Implements:[Events,Options],deleted:false,initialize:function(data,options){var self=this;self.setOptions(options);self.data=data||{};self.create();self.addEvent('change',function(){self.el[self.qualities.get('value')=='-1'?'addClass':'removeClass']('is_empty');self.deleted=self.qualities.get('value')=='-1';});},create:function(){var self=this;var data=self.data;self.el=new Element('li.type').adopt(new Element('span.quality_type').adopt(self.fillQualities()),new Element('span.finish').adopt(self.finish=new Element('input.inlay.finish[type=checkbox]',{'checked':data.finish!==undefined?data.finish:1,'events':{'change':function(e){if(self.el==self.el.getParent().getElement(':first-child')){self.finish_class.check();alert('Top quality always finishes the search')
return;}
self.fireEvent('change');}}})),new Element('span.delete.icon2',{'events':{'click':self.del.bind(self)}}),new Element('span.handle'));self.el[self.data.quality_id>0?'removeClass':'addClass']('is_empty');self.finish_class=new Form.Check(self.finish);},fillQualities:function(){var self=this;self.qualities=new Element('select',{'events':{'change':self.fireEvent.bind(self,'change')}}).adopt(new Element('option',{'text':'+ Add another quality','value':-1}));Object.each(Quality.qualities,function(q){new Element('option',{'text':q.label,'value':q.id}).inject(self.qualities)});self.qualities.set('value',self.data.quality_id);return self.qualities;},getData:function(){var self=this;return{'quality_id':self.qualities.get('value'),'finish':+self.finish.checked}},get:function(key){return this.data[key];},del:function(){var self=this;self.el.addClass('deleted');self.el.hide();self.deleted=true;self.fireEvent('change');},toElement:function(){return this.el;}})

// /root/.xbmc/addons/service.downloadmanager.InternetPVR/CouchPotatoServer/couchpotato/core/plugins/quality/static/quality.js:1401248968
var QualityBase=new Class({tab:'',content:'',setup:function(data){var self=this;self.qualities=data.qualities;self.profiles=[]
Array.each(data.profiles,self.createProfilesClass.bind(self));App.addEvent('load',self.addSettings.bind(self))},getProfile:function(id){return this.profiles.filter(function(profile){return profile.data.id==id}).pick()},getActiveProfiles:function(){return Array.filter(this.profiles,function(profile){return!profile.data.hide});},getQuality:function(id){return this.qualities.filter(function(q){return q.id==id;}).pick();},addSettings:function(){var self=this;self.settings=App.getPage('Settings')
self.settings.addEvent('create',function(){var tab=self.settings.createSubTab('profile',{'label':'Quality','name':'profile','subtab_label':'Qualities'},self.settings.tabs.searcher,'searcher');self.tab=tab.tab;self.content=tab.content;self.createProfiles();self.createProfileOrdering();self.createSizes();})},createProfiles:function(){var self=this;var non_core_profiles=Array.filter(self.profiles,function(profile){return!profile.isCore()});var count=non_core_profiles.length;self.settings.createGroup({'label':'Quality Profiles','description':'Create your own profiles with multiple qualities.'}).inject(self.content).adopt(self.profile_container=new Element('div.container'),new Element('a.add_new_profile',{'text':count>0?'Create another quality profile':'Click here to create a quality profile.','events':{'click':function(){var profile=self.createProfilesClass();$(profile).inject(self.profile_container)}}}));Array.each(non_core_profiles,function(profile){$(profile).inject(self.profile_container)});},createProfilesClass:function(data){var self=this;var data=data||{'id':randomString()}
var profile=new Profile(data)
self.profiles.include(profile)
return profile;},createProfileOrdering:function(){var self=this;var profile_list;var group=self.settings.createGroup({'label':'Profile Defaults','description':'(Needs refresh \''+(App.isMac()?'CMD+R':'F5')+'\' after editing)'}).adopt(new Element('.ctrlHolder#profile_ordering').adopt(new Element('label[text=Order]'),profile_list=new Element('ul'),new Element('p.formHint',{'html':'Change the order the profiles are in the dropdown list. Uncheck to hide it completely.<br />First one will be default.'}))).inject(self.content)
Array.each(self.profiles,function(profile){var check;new Element('li',{'data-id':profile.data.id}).adopt(check=new Element('input.inlay[type=checkbox]',{'checked':!profile.data.hide,'events':{'change':self.saveProfileOrdering.bind(self)}}),new Element('span.profile_label',{'text':profile.data.label}),new Element('span.handle')).inject(profile_list);new Form.Check(check);});self.profile_sortable=new Sortables(profile_list,{'revert':true,'handle':'','opacity':0.5,'onComplete':self.saveProfileOrdering.bind(self)});},saveProfileOrdering:function(){var self=this;var ids=[];var hidden=[];self.profile_sortable.list.getElements('li').each(function(el,nr){ids.include(el.get('data-id'));hidden[nr]=+!el.getElement('input[type=checkbox]').get('checked');});Api.request('profile.save_order',{'data':{'ids':ids,'hidden':hidden}});},createSizes:function(){var self=this;var group=self.settings.createGroup({'label':'Sizes','description':'Edit the minimal and maximum sizes (in MB) for each quality.','advanced':true,'name':'sizes'}).inject(self.content)
new Element('div.item.head.ctrlHolder').adopt(new Element('span.label',{'text':'Quality'}),new Element('span.min',{'text':'Min'}),new Element('span.max',{'text':'Max'})).inject(group)
Array.each(self.qualities,function(quality){new Element('div.ctrlHolder.item').adopt(new Element('span.label',{'text':quality.label}),new Element('input.min.inlay[type=text]',{'value':quality.size_min,'events':{'keyup':function(e){self.changeSize(quality.identifier,'size_min',e.target.get('value'))}}}),new Element('input.max.inlay[type=text]',{'value':quality.size_max,'events':{'keyup':function(e){self.changeSize(quality.identifier,'size_max',e.target.get('value'))}}})).inject(group)});},size_timer:{},changeSize:function(identifier,type,value){var self=this;if(self.size_timer[identifier+type])clearTimeout(self.size_timer[identifier+type]);self.size_timer[identifier+type]=(function(){Api.request('quality.size.save',{'data':{'identifier':identifier,'value_type':type,'value':value}});}).delay(300)}});window.Quality=new QualityBase();

// /root/.xbmc/addons/service.downloadmanager.InternetPVR/CouchPotatoServer/couchpotato/core/plugins/status/static/status.js:1401248968
var StatusBase=new Class({setup:function(statuses){var self=this;self.statuses=statuses;},get:function(id){return this.statuses.filter(function(status){return status.id==id}).pick()},});window.Status=new StatusBase();

// /root/.xbmc/addons/service.downloadmanager.InternetPVR/CouchPotatoServer/couchpotato/core/plugins/userscript/static/userscript.js:1401248969
Page.Userscript=new Class({Extends:PageBase,name:'userscript',has_tab:false,options:{'onOpened':function(){App.fireEvent('unload');App.getBlock('header').hide();}},indexAction:function(param){var self=this;self.el.adopt(self.frame=new Element('div.frame.loading',{'text':'Loading...'}));var url=window.location.href.split('url=')[1];Api.request('userscript.add_via_url',{'data':{'url':url},'onComplete':function(json){self.frame.empty();self.frame.removeClass('loading');if(json.error)
self.frame.set('html',json.error);else{var item=new Block.Search.MovieItem(json.movie);self.frame.adopt(item);item.showOptions();}}});}});var UserscriptSettingTab=new Class({tab:'',content:'',initialize:function(){var self=this;App.addEvent('load',self.addSettings.bind(self))},addSettings:function(){var self=this;self.settings=App.getPage('Settings')
self.settings.addEvent('create',function(){var host_url=window.location.protocol+'//'+window.location.host;self.settings.createGroup({'name':'userscript','label':'Install the bookmarklet or userscript','description':'Easily add movies via imdb.com, appletrailers and more'}).inject(self.settings.tabs.automation.content,'top').adopt(new Element('a.userscript.button',{'text':'Install userscript','href':Api.createUrl('userscript.get')+randomString()+'/couchpotato.user.js','target':'_blank'}),new Element('span.or[text=or]'),new Element('span.bookmarklet').adopt(new Element('a.button.green',{'text':'+CouchPotato','href':"javascript:void((function(){var e=document.createElement('script');e.setAttribute('type','text/javascript');e.setAttribute('charset','UTF-8');e.setAttribute('src','"+
host_url+Api.createUrl('userscript.bookmark')+"?host="+encodeURI(host_url+Api.createUrl('userscript.get')+randomString()+'/')+"&r='+Math.random()*99999999);document.body.appendChild(e)})());",'target':'','events':{'click':function(e){(e).stop()
alert('Drag it to your bookmark ;)')}}}),new Element('span',{'text':'â‡½ Drag this to your bookmarks'}))).setStyles({'background-image':"url('"+App.createUrl('static/plugin/userscript/userscript.png')+"')"});});}});window.addEvent('domready',function(){new UserscriptSettingTab();});window.addEvent('load',function(){var your_version=$(document.body).get('data-userscript_version'),latest_version=App.getOption('userscript_version')||'',key='cp_version_check',checked_already=Cookie.read(key);if(your_version&&your_version<latest_version&&checked_already<latest_version){if(confirm("Update to the latest Userscript?\nYour version: "+your_version+', new version: '+latest_version)){document.location=Api.createUrl('userscript.get')+randomString()+'/couchpotato.user.js';}
Cookie.write(key,latest_version,{duration:100});}});

// /root/.xbmc/addons/service.downloadmanager.InternetPVR/CouchPotatoServer/couchpotato/core/plugins/wizard/static/wizard.js:1401248969
Page.Wizard=new Class({Extends:Page.Settings,name:'wizard',has_tab:false,wizard_only:true,headers:{'welcome':{'title':'Welcome to the new CouchPotato','description':'To get started, fill in each of the following settings as much as you can.','content':new Element('div',{'styles':{'margin':'0 0 0 30px'}})},'general':{'title':'General','description':'If you want to access CP from outside your local network, you better secure it a bit with a username & password.'},'downloaders':{'title':'What download apps are you using?','description':'CP needs an external download app to work with. Choose one below. For more downloaders check settings after you have filled in the wizard. If your download app isn\'t in the list, use the default Blackhole.'},'searcher':{'label':'Providers','title':'Are you registered at any of these sites?','description':'CP uses these sites to search for movies. A few free are enabled by default, but it\'s always better to have more.'},'renamer':{'title':'Move & rename the movies after downloading?','description':'The coolest part of CP is that it can move and organize your downloaded movies automagically. Check settings and you can even download trailers, subtitles and other data when it has finished downloading. It\'s awesome!'},'automation':{'title':'Easily add movies to your wanted list!','description':'You can easily add movies from your favorite movie site, like IMDB, Rotten Tomatoes, Apple Trailers and more. Just install the userscript or drag the bookmarklet to your browsers bookmarks.'+'<br />Once installed, just click the bookmarklet on a movie page and watch the magic happen ;)','content':function(){return App.createUserscriptButtons().setStyles({'background-image':"url('"+App.createUrl('static/plugin/userscript/userscript.png')+"')"})}},'finish':{'title':'Finishing Up','description':'Are you done? Did you fill in everything as much as possible?'+'<br />Be sure to check the settings to see what more CP can do!<br /><br />'+'<div class="wizard_support">After you\'ve used CP for a while, and you like it (which of course you will), consider supporting CP. Maybe even by writing some code. <br />Or by getting a subscription at <a href="https://usenetserver.com/partners/?a_aid=couchpotato&a_bid=3f357c6f">Usenet Server</a> or <a href="http://www.newshosting.com/partners/?a_aid=couchpotato&a_bid=a0b022df">Newshosting</a>.</div>','content':new Element('div').adopt(new Element('a.button.green',{'styles':{'margin-top':20},'text':'I\'m ready to start the awesomeness, wow this button is big and green!','events':{'click':function(e){(e).preventDefault();Api.request('settings.save',{'data':{'section':'core','name':'show_wizard','value':0},'useSpinner':true,'spinnerOptions':{'target':self.el},'onComplete':function(){window.location=App.createUrl('wanted');}});}}}))}},groups:['welcome','general','downloaders','searcher','renamer','automation','finish'],open:function(action,params){var self=this;if(!self.initialized){App.fireEvent('unload');App.getBlock('header').hide();self.parent(action,params);self.addEvent('create',function(){self.order();});self.initialized=true;self.scroll=new Fx.Scroll(document.body,{'transition':'quint:in:out'});}
else
(function(){var sc=self.el.getElement('.wgroup_'+action);self.scroll.start(0,sc.getCoordinates().top-80);}).delay(1)},order:function(){var self=this;var form=self.el.getElement('.uniForm');var tabs=self.el.getElement('.tabs');self.groups.each(function(group,nr){if(self.headers[group]){group_container=new Element('.wgroup_'+group,{'styles':{'opacity':0.2},'tween':{'duration':350}});if(self.headers[group].include){self.headers[group].include.each(function(inc){group_container.addClass('wgroup_'+inc);})}
var content=self.headers[group].content
group_container.adopt(new Element('h1',{'text':self.headers[group].title}),self.headers[group].description?new Element('span.description',{'html':self.headers[group].description}):null,content?(typeOf(content)=='function'?content():content):null).inject(form);}
var tab_navigation=tabs.getElement('.t_'+group);if(!tab_navigation&&self.headers[group]&&self.headers[group].include){tab_navigation=[]
self.headers[group].include.each(function(inc){tab_navigation.include(tabs.getElement('.t_'+inc));})}
if(tab_navigation&&group_container){tabs.adopt(tab_navigation);if(self.headers[group]&&self.headers[group].include){self.headers[group].include.each(function(inc){self.el.getElement('.tab_'+inc).inject(group_container);})
new Element('li.t_'+group).adopt(new Element('a',{'href':App.createUrl('wizard/'+group),'text':(self.headers[group].label||group).capitalize()})).inject(tabs)}
else
self.el.getElement('.tab_'+group).inject(group_container);if(tab_navigation.getElement&&self.headers[group]){var a=tab_navigation.getElement('a');a.set('text',(self.headers[group].label||group).capitalize());var url_split=a.get('href').split('wizard')[1].split('/');if(url_split.length>3)
a.set('href',a.get('href').replace(url_split[url_split.length-3]+'/',''));}}
else{new Element('li.t_'+group).adopt(new Element('a',{'href':App.createUrl('wizard/'+group),'text':(self.headers[group].label||group).capitalize()})).inject(tabs);}
if(self.headers[group]&&self.headers[group].event)
self.headers[group].event.call()});self.el.getElement('.advanced_toggle').destroy();self.el.getElement('.section_nzb').hide();new Element('.tab_wrapper').wraps(tabs);var minimum=self.el.getSize().y-window.getSize().y;self.groups.each(function(group,nr){var g=self.el.getElement('.wgroup_'+group);if(!g||!g.isVisible())return;var t=self.el.getElement('.t_'+group);if(!t)return;var func=function(){self.groups.each(function(groups2,nr2){var t2=self.el.getElement('.t_'+groups2);t2[nr2>nr?'removeClass':'addClass']('done');})
g.tween('opacity',1);}
if(nr==0)
func();new ScrollSpy({min:function(){var c=g.getCoordinates();var top=c.top-(window.getSize().y/2);return top>minimum?minimum:top},max:function(){var c=g.getCoordinates();return c.top+(c.height/2)},onEnter:func,onLeave:function(){g.tween('opacity',0.2)}});});}});

// /root/.xbmc/addons/service.downloadmanager.InternetPVR/CouchPotatoServer/couchpotato/core/notifications/core/static/notification.js:1401248967
var NotificationBase=new Class({Extends:BlockBase,Implements:[Options,Events],initialize:function(options){var self=this;self.setOptions(options);App.addEvent('unload',self.stopPoll.bind(self));App.addEvent('reload',self.startInterval.bind(self,[true]));App.on('notification',self.notify.bind(self));App.on('message',self.showMessage.bind(self));App.addEvent('load',self.addTestButtons.bind(self));self.notifications=[]
App.addEvent('load',function(){App.block.notification=new Block.Menu(self,{'button_class':'icon2.eye-open','class':'notification_menu','onOpen':self.markAsRead.bind(self)})
$(App.block.notification).inject(App.getBlock('search'),'after');self.badge=new Element('div.badge').inject(App.block.notification,'top').hide();});window.addEvent('load',function(){self.startInterval.delay($(window).getSize().x<=480?2000:100,self);})},notify:function(result){var self=this;var added=new Date();added.setTime(result.added*1000)
result.el=App.getBlock('notification').addLink(new Element('span.'+(result.read?'read':'')).adopt(new Element('span.message',{'html':result.message}),new Element('span.added',{'text':added.timeDiffInWords(),'title':added})),'top');self.notifications.include(result);if((result.data.important!==undefined||result.data.sticky!==undefined)&&!result.read){var sticky=true
App.trigger('message',[result.message,sticky,result])}
else if(!result.read){self.setBadge(self.notifications.filter(function(n){return!n.read}).length)}},setBadge:function(value){var self=this;self.badge.set('text',value)
self.badge[value?'show':'hide']()},markAsRead:function(force_ids){var self=this,ids=force_ids;if(!force_ids){var rn=self.notifications.filter(function(n){return!n.read&&n.data.important===undefined})
var ids=[]
rn.each(function(n){ids.include(n.id)})}
if(ids.length>0)
Api.request('notification.markread',{'data':{'ids':ids.join(',')},'onSuccess':function(){self.setBadge('')}})},startInterval:function(force){var self=this;if(self.stopped&&!force){self.stopped=false;return;}
self.request=Api.request('notification.listener',{'data':{'init':true},'onSuccess':self.processData.bind(self)}).send()
setInterval(function(){if(self.request&&self.request.isRunning()){self.request.cancel();self.startPoll()}},120000);},startPoll:function(){var self=this;if(self.stopped||(self.request&&self.request.isRunning()))
return;self.request=Api.request('nonblock/notification.listener',{'onSuccess':self.processData.bind(self),'data':{'last_id':self.last_id},'onFailure':function(){self.startPoll.delay(2000,self)}}).send()},stopPoll:function(){if(this.request)
this.request.cancel()
this.stopped=true;},processData:function(json){var self=this;if(json){Array.each(json.result,function(result){App.trigger(result.type,[result]);if(result.message&&result.read===undefined)
self.showMessage(result.message);})
if(json.result.length>0)
self.last_id=json.result.getLast().message_id}
self.startPoll.delay(1500,self);},showMessage:function(message,sticky,data){var self=this;if(!self.message_container)
self.message_container=new Element('div.messages').inject(document.body);var new_message=new Element('div',{'class':'message'+(sticky?' sticky':''),'html':message}).inject(self.message_container,'top');setTimeout(function(){new_message.addClass('show')},10);var hide_message=function(){new_message.addClass('hide')
setTimeout(function(){new_message.destroy();},1000);}
if(sticky)
new_message.grab(new Element('a.close.icon2',{'events':{'click':function(){self.markAsRead([data.id]);hide_message();}}}));else
setTimeout(hide_message,4000);},addTestButtons:function(){var self=this;var setting_page=App.getPage('Settings')
setting_page.addEvent('create',function(){Object.each(setting_page.tabs.notifications.groups,self.addTestButton.bind(self))})},addTestButton:function(fieldset,plugin_name){var self=this,button_name=self.testButtonName(fieldset);if(button_name.contains('Notifications'))return;new Element('.ctrlHolder.test_button').adopt(new Element('a.button',{'text':button_name,'events':{'click':function(){var button=fieldset.getElement('.test_button .button');button.set('text','Sending notification');Api.request('notify.'+plugin_name+'.test',{'onComplete':function(json){button.set('text',button_name);if(json.success){var message=new Element('span.success',{'text':'Notification successful'}).inject(button,'after')}
else{var message=new Element('span.failed',{'text':'Notification failed. Check logs for details.'}).inject(button,'after')}
(function(){message.destroy();}).delay(3000)}});}}})).inject(fieldset);},testButtonName:function(fieldset){var name=String(fieldset.getElement('h2').innerHTML).substring(0,String(fieldset.getElement('h2').innerHTML).indexOf("<span"));return'Test '+name;}});window.Notification=new NotificationBase();

// /root/.xbmc/addons/service.downloadmanager.InternetPVR/CouchPotatoServer/couchpotato/core/notifications/twitter/static/twitter.js:1401248968
var TwitterNotification=new Class({initialize:function(){var self=this;App.addEvent('load',self.addRegisterButton.bind(self));},addRegisterButton:function(){var self=this;var setting_page=App.getPage('Settings');setting_page.addEvent('create',function(){var fieldset=setting_page.tabs.notifications.groups.twitter,l=window.location;var twitter_set=0;fieldset.getElements('input[type=text]').each(function(el){twitter_set+=+(el.get('value')!='');});new Element('.ctrlHolder').adopt((twitter_set>0)?[self.unregister=new Element('a.button.red',{'text':'Unregister "'+fieldset.getElement('input[name*=screen_name]').get('value')+'"','events':{'click':function(){fieldset.getElements('input[type=text]').set('value','').fireEvent('change');self.unregister.destroy();self.unregister_or.destroy();}}}),self.unregister_or=new Element('span[text=or]')]:null,new Element('a.button',{'text':twitter_set>0?'Register a different account':'Register your Twitter account','events':{'click':function(){Api.request('notify.twitter.auth_url',{'data':{'host':l.protocol+'//'+l.hostname+(l.port?':'+l.port:'')},'onComplete':function(json){window.location=json.url;}});}}})).inject(fieldset.getElement('.test_button'),'before');})},});window.addEvent('domready',function(){new TwitterNotification();});

// /root/.xbmc/addons/service.downloadmanager.InternetPVR/CouchPotatoServer/couchpotato/core/media/_base/search/static/search.js:1401248965
Block.Search=new Class({Extends:BlockBase,cache:{},create:function(){var self=this;var focus_timer=0;self.el=new Element('div.search_form').adopt(new Element('div.input').adopt(self.input=new Element('input',{'placeholder':'Search & add a new media','events':{'keyup':self.keyup.bind(self),'focus':function(){if(focus_timer)clearTimeout(focus_timer);self.el.addClass('focused')
if(this.get('value'))
self.hideResults(false)},'blur':function(){focus_timer=(function(){self.el.removeClass('focused')}).delay(100);}}}),new Element('a.icon2',{'events':{'click':self.clear.bind(self),'touchend':self.clear.bind(self)}})),self.result_container=new Element('div.results_container',{'tween':{'duration':200},'events':{'mousewheel':function(e){(e).stopPropagation();}}}).adopt(self.results=new Element('div.results')));self.mask=new Element('div.mask').inject(self.result_container).fade('hide');},clear:function(e){var self=this;(e).preventDefault();if(self.last_q===''){self.input.blur()
self.last_q=null;}
else{self.last_q='';self.input.set('value','');self.input.focus()
self.media={}
self.results.empty()
self.el.removeClass('filled')}},hideResults:function(bool){var self=this;if(self.hidden==bool)return;self.el[bool?'removeClass':'addClass']('shown');if(bool){History.removeEvent('change',self.hideResults.bind(self,!bool));self.el.removeEvent('outerClick',self.hideResults.bind(self,!bool));}
else{History.addEvent('change',self.hideResults.bind(self,!bool));self.el.addEvent('outerClick',self.hideResults.bind(self,!bool));}
self.hidden=bool;},keyup:function(e){var self=this;self.el[self.q()?'addClass':'removeClass']('filled')
if(self.q()!=self.last_q){if(self.api_request&&self.api_request.isRunning())
self.api_request.cancel();if(self.autocomplete_timer)clearTimeout(self.autocomplete_timer)
self.autocomplete_timer=self.autocomplete.delay(300,self)}},autocomplete:function(){var self=this;if(!self.q()){self.hideResults(true)
return}
self.list()},list:function(){var self=this,q=self.q(),cache=self.cache[q];self.hideResults(false);if(!cache){self.mask.fade('in');if(!self.spinner)
self.spinner=createSpinner(self.mask);self.api_request=Api.request('search',{'data':{'q':q},'onComplete':self.fill.bind(self,q)})}
else
self.fill(q,cache)
self.last_q=q;},fill:function(q,json){var self=this;self.cache[q]=json
self.media={}
self.results.empty()
Object.each(json,function(media,type){if(typeOf(media)=='array'){Object.each(media,function(m){var m=new Block.Search[m.type.capitalize()+'Item'](m);$(m).inject(self.results)
self.media[m.imdb||'r-'+Math.floor(Math.random()*10000)]=m
if(q==m.imdb)
m.showOptions()});}})
var w=window.getSize(),rc=self.result_container.getCoordinates();self.results.setStyle('max-height',(w.y-rc.top-50)+'px')
self.mask.fade('out')},loading:function(bool){this.el[bool?'addClass':'removeClass']('loading')},q:function(){return this.input.get('value').trim();}});

// /root/.xbmc/addons/service.downloadmanager.InternetPVR/CouchPotatoServer/couchpotato/core/media/movie/_base/static/list.js:1401248966
var MovieList=new Class({Implements:[Events,Options],options:{navigation:true,limit:50,load_more:true,loader:true,menu:[],add_new:false,force_view:false},movies:[],movies_added:{},total_movies:0,letters:{},filter:null,initialize:function(options){var self=this;self.setOptions(options);self.offset=0;self.filter=self.options.filter||{'starts_with':null,'search':null}
self.el=new Element('div.movies').adopt(self.title=self.options.title?new Element('h2',{'text':self.options.title,'styles':{'display':'none'}}):null,self.description=self.options.description?new Element('div.description',{'html':self.options.description,'styles':{'display':'none'}}):null,self.movie_list=new Element('div'),self.load_more=self.options.load_more?new Element('a.load_more',{'events':{'click':self.loadMore.bind(self)}}):null);if($(window).getSize().x<=480&&!self.options.force_view)
self.changeView('list');else
self.changeView(self.getSavedView()||self.options.view||'details');self.getMovies();App.on('movie.added',self.movieAdded.bind(self))
App.on('movie.deleted',self.movieDeleted.bind(self))},movieDeleted:function(notification){var self=this;if(self.movies_added[notification.data.id]){self.movies.each(function(movie){if(movie.get('id')==notification.data.id){movie.destroy();delete self.movies_added[notification.data.id];self.setCounter(self.counter_count-1);self.total_movies--;}})}
self.checkIfEmpty();},movieAdded:function(notification){var self=this;self.fireEvent('movieAdded',notification);if(self.options.add_new&&!self.movies_added[notification.data.id]&&notification.data.status.identifier==self.options.status){window.scroll(0,0);self.createMovie(notification.data,'top');self.setCounter(self.counter_count+1);self.checkIfEmpty();}},create:function(){var self=this;if(self.options.navigation)
self.createNavigation();if(self.options.load_more)
self.scrollspy=new ScrollSpy({min:function(){var c=self.load_more.getCoordinates()
return c.top-window.document.getSize().y-300},onEnter:self.loadMore.bind(self)});self.created=true;},addMovies:function(movies,total){var self=this;if(!self.created)self.create();if(movies.length<self.options.limit&&self.scrollspy){self.load_more.hide();self.scrollspy.stop();}
Object.each(movies,function(movie){self.createMovie(movie);});self.total_movies+=total;self.setCounter(total);},setCounter:function(count){var self=this;if(!self.navigation_counter)return;self.counter_count=count;self.navigation_counter.set('text',(count||0)+' movies');if(self.empty_message){self.empty_message.destroy();self.empty_message=null;}
if(self.total_movies&&count==0&&!self.empty_message){var message=(self.filter.search?'for "'+self.filter.search+'"':'')+
(self.filter.starts_with?' in <strong>'+self.filter.starts_with+'</strong>':'');self.empty_message=new Element('.message',{'html':'No movies found '+message+'.<br/>'}).grab(new Element('a',{'text':'Reset filter','events':{'click':function(){self.filter={'starts_with':null,'search':null};self.navigation_search_input.set('value','');self.reset();self.activateLetter();self.getMovies(true);self.last_search_value='';}}})).inject(self.movie_list);}},createMovie:function(movie,inject_at){var self=this;var m=new Movie(self,{'actions':self.options.actions,'view':self.current_view,'onSelect':self.calculateSelected.bind(self)},movie);$(m).inject(self.movie_list,inject_at||'bottom');m.fireEvent('injected');self.movies.include(m)
self.movies_added[movie.id]=true;},createNavigation:function(){var self=this;var chars='#ABCDEFGHIJKLMNOPQRSTUVWXYZ';self.el.addClass('with_navigation')
self.navigation=new Element('div.alph_nav').adopt(self.mass_edit_form=new Element('div.mass_edit_form').adopt(new Element('span.select').adopt(self.mass_edit_select=new Element('input[type=checkbox].inlay',{'events':{'change':self.massEditToggleAll.bind(self)}}),self.mass_edit_selected=new Element('span.count',{'text':0}),self.mass_edit_selected_label=new Element('span',{'text':'selected'})),new Element('div.quality').adopt(self.mass_edit_quality=new Element('select'),new Element('a.button.orange',{'text':'Change quality','events':{'click':self.changeQualitySelected.bind(self)}})),new Element('div.delete').adopt(new Element('span[text=or]'),new Element('a.button.red',{'text':'Delete','events':{'click':self.deleteSelected.bind(self)}})),new Element('div.refresh').adopt(new Element('span[text=or]'),new Element('a.button.green',{'text':'Refresh','events':{'click':self.refreshSelected.bind(self)}}))),new Element('div.menus').adopt(self.navigation_counter=new Element('span.counter[title=Total]'),self.filter_menu=new Block.Menu(self,{'class':'filter'}),self.navigation_actions=new Element('ul.actions',{'events':{'click:relay(li)':function(e,el){var a='active';self.navigation_actions.getElements('.'+a).removeClass(a);self.changeView(el.get('data-view'));this.addClass(a);el.inject(el.getParent(),'top');el.getSiblings().hide()
setTimeout(function(){el.getSiblings().setStyle('display',null);},100)}}}),self.navigation_menu=new Block.Menu(self,{'class':'extra'}))).inject(self.el,'top');self.mass_edit_select_class=new Form.Check(self.mass_edit_select);Quality.getActiveProfiles().each(function(profile){new Element('option',{'value':profile.id?profile.id:profile.data.id,'text':profile.label?profile.label:profile.data.label}).inject(self.mass_edit_quality)});self.filter_menu.addLink(self.navigation_search_input=new Element('input',{'title':'Search through '+self.options.identifier,'placeholder':'Search through '+self.options.identifier,'events':{'keyup':self.search.bind(self),'change':self.search.bind(self)}})).addClass('search');var available_chars;self.filter_menu.addEvent('open',function(){self.navigation_search_input.focus();if(!available_chars&&(self.navigation.isDisplayed()||self.navigation.isVisible()))
Api.request('media.available_chars',{'data':Object.merge({'status':self.options.status},self.filter),'onSuccess':function(json){available_chars=json.chars
json.chars.split('').each(function(c){self.letters[c.capitalize()].addClass('available')})}});});self.filter_menu.addLink(self.navigation_alpha=new Element('ul.numbers',{'events':{'click:relay(li.available)':function(e,el){self.activateLetter(el.get('data-letter'))
self.getMovies(true)}}}));['mass_edit','details','list'].each(function(view){var current=self.current_view==view;new Element('li',{'class':'icon2 '+view+(current?' active ':''),'data-view':view}).inject(self.navigation_actions,current?'top':'bottom');});self.letters['all']=new Element('li.letter_all.available.active',{'text':'ALL',}).inject(self.navigation_alpha);chars.split('').each(function(c){self.letters[c]=new Element('li',{'text':c,'class':'letter_'+c,'data-letter':c}).inject(self.navigation_alpha);});if(self.options.menu.length>0)
self.options.menu.each(function(menu_item){self.navigation_menu.addLink(menu_item);})
else
self.navigation_menu.hide();},calculateSelected:function(){var self=this;var selected=0,movies=self.movies.length;self.movies.each(function(movie){selected+=movie.isSelected()?1:0})
var indeterminate=selected>0&&selected<movies,checked=selected==movies&&selected>0;self.mass_edit_select.set('indeterminate',indeterminate)
self.mass_edit_select_class[checked?'check':'uncheck']()
self.mass_edit_select_class.element[indeterminate?'addClass':'removeClass']('indeterminate')
self.mass_edit_selected.set('text',selected);},deleteSelected:function(){var self=this,ids=self.getSelectedMovies(),help_msg=self.identifier=='wanted'?'If you do, you won\'t be able to watch them, as they won\'t get downloaded!':'Your files will be safe, this will only delete the reference from the CouchPotato manage list';var qObj=new Question('Are you sure you want to delete '+ids.length+' movie'+(ids.length!=1?'s':'')+'?',help_msg,[{'text':'Yes, delete '+(ids.length!=1?'them':'it'),'class':'delete','events':{'click':function(e){(e).preventDefault();this.set('text','Deleting..')
Api.request('media.delete',{'data':{'id':ids.join(','),'delete_from':self.options.identifier},'onSuccess':function(){qObj.close();var erase_movies=[];self.movies.each(function(movie){if(movie.isSelected()){$(movie).destroy()
erase_movies.include(movie);}});erase_movies.each(function(movie){self.movies.erase(movie);movie.destroy();self.setCounter(self.counter_count-1);self.total_movies--;});self.calculateSelected();}});}}},{'text':'Cancel','cancel':true}]);},changeQualitySelected:function(){var self=this;var ids=self.getSelectedMovies()
Api.request('movie.edit',{'data':{'id':ids.join(','),'profile_id':self.mass_edit_quality.get('value')},'onSuccess':self.search.bind(self)});},refreshSelected:function(){var self=this;var ids=self.getSelectedMovies()
Api.request('media.refresh',{'data':{'id':ids.join(','),}});},getSelectedMovies:function(){var self=this;var ids=[]
self.movies.each(function(movie){if(movie.isSelected())
ids.include(movie.get('id'))});return ids},massEditToggleAll:function(){var self=this;var select=self.mass_edit_select.get('checked');self.movies.each(function(movie){movie.select(select)});self.calculateSelected()},reset:function(){var self=this;self.movies=[]
if(self.mass_edit_select)
self.calculateSelected()
if(self.navigation_alpha)
self.navigation_alpha.getElements('.active').removeClass('active')
self.offset=0;if(self.scrollspy){self.load_more.show();self.scrollspy.start();}},activateLetter:function(letter){var self=this;self.reset()
self.letters[letter||'all'].addClass('active');self.filter.starts_with=letter;},changeView:function(new_view){var self=this;self.el.removeClass(self.current_view+'_list').addClass(new_view+'_list')
self.current_view=new_view;Cookie.write(self.options.identifier+'_view2',new_view,{duration:1000});},getSavedView:function(){var self=this;return Cookie.read(self.options.identifier+'_view2');},search:function(){var self=this;if(self.search_timer)clearTimeout(self.search_timer);self.search_timer=(function(){var search_value=self.navigation_search_input.get('value');if(search_value==self.last_search_value)return
self.reset()
self.activateLetter();self.filter.search=search_value;self.getMovies(true);self.last_search_value=search_value;}).delay(250);},update:function(){var self=this;self.reset();self.getMovies(true);},getMovies:function(reset){var self=this;if(self.scrollspy){self.scrollspy.stop();self.load_more.set('text','loading...');}
if(self.movies.length==0&&self.options.loader){self.loader_first=new Element('div.loading').adopt(new Element('div.message',{'text':self.options.title?'Loading \''+self.options.title+'\'':'Loading...'})).inject(self.el,'top');createSpinner(self.loader_first,{radius:4,length:4,width:1});self.el.setStyle('min-height',93);}
Api.request(self.options.api_call||'media.list',{'data':Object.merge({'type':'movie','status':self.options.status,'limit_offset':self.options.limit?self.options.limit+','+self.offset:null},self.filter),'onSuccess':function(json){if(reset)
self.movie_list.empty();if(self.loader_first){var lf=self.loader_first;self.loader_first.addClass('hide')
self.loader_first=null;setTimeout(function(){lf.destroy();},20000);self.el.setStyle('min-height',null);}
self.store(json.movies);self.addMovies(json.movies,json.total||json.movies.length);if(self.scrollspy){self.load_more.set('text','load more movies');self.scrollspy.start();}
self.checkIfEmpty();self.fireEvent('loaded');}});},loadMore:function(){var self=this;if(self.offset>=self.options.limit)
self.getMovies()},store:function(movies){var self=this;self.offset+=movies.length;},checkIfEmpty:function(){var self=this;var is_empty=self.movies.length==0&&(self.total_movies==0||self.total_movies===undefined);if(self.title)
self.title[is_empty?'hide':'show']()
if(self.description)
self.description.setStyle('display',[is_empty?'none':''])
if(is_empty&&self.options.on_empty_element){self.options.on_empty_element.inject(self.loader_first||self.title||self.movie_list,'after');if(self.navigation)
self.navigation.hide();self.empty_element=self.options.on_empty_element;}
else if(self.empty_element){self.empty_element.destroy();if(self.navigation)
self.navigation.show();}},toElement:function(){return this.el;}});

// /root/.xbmc/addons/service.downloadmanager.InternetPVR/CouchPotatoServer/couchpotato/core/media/movie/_base/static/movie.actions.js:1401248966
var MovieAction=new Class({Implements:[Options],class_name:'action icon2',initialize:function(movie,options){var self=this;self.setOptions(options);self.movie=movie;self.create();if(self.el)
self.el.addClass(self.class_name)},create:function(){},disable:function(){if(this.el)
this.el.addClass('disable')},enable:function(){if(this.el)
this.el.removeClass('disable')},getTitle:function(){var self=this;try{return self.movie.getTitle();}
catch(e){try{return self.movie.original_title?self.movie.original_title:self.movie.titles[0];}
catch(e){return'Unknown';}}},get:function(key){var self=this;try{return self.movie.get(key)}
catch(e){return self.movie[key]}},createMask:function(){var self=this;self.mask=new Element('div.mask',{'styles':{'z-index':'1'}}).inject(self.movie,'top').fade('hide');},positionMask:function(){var self=this,movie=$(self.movie),s=movie.getSize()
return;return self.mask.setStyles({'width':s.x,'height':s.y}).position({'relativeTo':movie})},toElement:function(){return this.el||null}});var MA={};MA.IMDB=new Class({Extends:MovieAction,id:null,create:function(){var self=this;self.id=self.movie.get('imdb')||self.movie.get('identifier');self.el=new Element('a.imdb',{'title':'Go to the IMDB page of '+self.getTitle(),'href':'http://www.imdb.com/title/'+self.id+'/','target':'_blank'});if(!self.id)self.disable();}});MA.Release=new Class({Extends:MovieAction,create:function(){var self=this;self.el=new Element('a.releases.download',{'title':'Show the releases that are available for '+self.getTitle(),'events':{'click':self.show.bind(self)}});if(self.movie.data.releases.length==0)
self.el.hide()
else
self.showHelper();App.on('movie.searcher.ended',function(notification){if(self.movie.data.id!=notification.data.id)return;self.releases=null;if(self.options_container){self.options_container.destroy();self.options_container=null;}});},show:function(e){var self=this;if(e)
(e).preventDefault();if(self.releases)
self.createReleases();else{self.movie.busy(true);Api.request('release.for_movie',{'data':{'id':self.movie.data.id},'onComplete':function(json){self.movie.busy(false,1);if(json&&json.releases){self.releases=json.releases;self.createReleases();}
else
alert('Something went wrong, check the logs.');}});}},createReleases:function(){var self=this;if(!self.options_container){self.options_container=new Element('div.options').grab(self.release_container=new Element('div.releases.table'));new Element('div.item.head').adopt(new Element('span.name',{'text':'Release name'}),new Element('span.status',{'text':'Status'}),new Element('span.quality',{'text':'Quality'}),new Element('span.size',{'text':'Size'}),new Element('span.age',{'text':'Age'}),new Element('span.score',{'text':'Score'}),new Element('span.provider',{'text':'Provider'})).inject(self.release_container)
self.releases.each(function(release){var status=Status.get(release.status_id),quality=Quality.getProfile(release.quality_id)||{},info=release.info,provider=self.get(release,'provider')+(release.info['provider_extra']?self.get(release,'provider_extra'):'');release.status=status;var release_name=self.get(release,'name');if(release.files&&release.files.length>0){try{var movie_file=release.files.filter(function(file){var type=File.Type.get(file.type_id);return type&&type.identifier=='movie'}).pick();release_name=movie_file.path.split(Api.getOption('path_sep')).getLast();}
catch(e){}}
var item=new Element('div',{'class':'item '+status.identifier,'id':'release_'+release.id}).adopt(new Element('span.name',{'text':release_name,'title':release_name}),new Element('span.status',{'text':status.identifier,'class':'release_status '+status.identifier}),new Element('span.quality',{'text':quality.get('label')||'n/a'}),new Element('span.size',{'text':release.info['size']?Math.floor(self.get(release,'size')):'n/a'}),new Element('span.age',{'text':self.get(release,'age')}),new Element('span.score',{'text':self.get(release,'score')}),new Element('span.provider',{'text':provider,'title':provider}),release.info['detail_url']?new Element('a.info.icon2',{'href':release.info['detail_url'],'target':'_blank'}):new Element('a'),new Element('a.download.icon2',{'events':{'click':function(e){(e).preventDefault();if(!this.hasClass('completed'))
self.download(release);}}}),new Element('a.delete.icon2',{'events':{'click':function(e){(e).preventDefault();self.ignore(release);}}})).inject(self.release_container);release['el']=item;if(status.identifier=='ignored'||status.identifier=='failed'||status.identifier=='snatched'){if(!self.last_release||(self.last_release&&self.last_release.status.identifier!='snatched'&&status.identifier=='snatched'))
self.last_release=release;}
else if(!self.next_release&&status.identifier=='available'){self.next_release=release;}
var update_handle=function(notification){if(notification.data.id!=release.id)return;var q=self.movie.quality.getElement('.q_id'+release.quality_id),status=Status.get(release.status_id),new_status=Status.get(notification.data.status_id);release.status_id=new_status.id
release.el.set('class','item '+new_status.identifier);var status_el=release.el.getElement('.release_status');status_el.set('class','release_status '+new_status.identifier);status_el.set('text',new_status.identifier);if(!q&&(new_status.identifier=='snatched'||new_status.identifier=='seeding'||new_status.identifier=='done'))
var q=self.addQuality(release.quality_id);if(new_status&&q&&!q.hasClass(new_status.identifier)){q.removeClass(status.identifier).addClass(new_status.identifier);q.set('title',q.get('title').replace(status.label,new_status.label));}}
App.on('release.update_status',update_handle);});if(self.last_release)
self.release_container.getElements('#release_'+self.last_release.id).addClass('last_release');if(self.next_release)
self.release_container.getElements('#release_'+self.next_release.id).addClass('next_release');if(self.next_release||(self.last_release&&['ignored','failed'].indexOf(self.last_release.status.identifier)===false)){self.trynext_container=new Element('div.buttons.try_container').inject(self.release_container,'top');var nr=self.next_release,lr=self.last_release;self.trynext_container.adopt(new Element('span.or',{'text':'This movie is snatched, if anything went wrong, download'}),lr?new Element('a.button.orange',{'text':'the same release again','events':{'click':function(){self.download(lr);}}}):null,nr&&lr?new Element('span.or',{'text':','}):null,nr?[new Element('a.button.green',{'text':lr?'another release':'the best release','events':{'click':function(){self.download(nr);}}}),new Element('span.or',{'text':'or pick one below'})]:null)}
self.last_release=null;self.next_release=null;}
self.options_container.inject(self.movie,'top');self.movie.slide('in',self.options_container);},showHelper:function(e){var self=this;if(e)
(e).preventDefault();var has_available=false,has_snatched=false;self.movie.data.releases.each(function(release){if(has_available&&has_snatched)return;var status=Status.get(release.status_id);if(['snatched','downloaded','seeding'].contains(status.identifier))
has_snatched=true;if(['available'].contains(status.identifier))
has_available=true;});if(has_available||has_snatched){self.trynext_container=new Element('div.buttons.trynext').inject(self.movie.info_container);self.trynext_container.adopt(has_available?[new Element('a.icon2.readd',{'text':has_snatched?'Download another release':'Download the best release','events':{'click':self.tryNextRelease.bind(self)}}),new Element('a.icon2.download',{'text':'pick one yourself','events':{'click':function(){self.movie.quality.fireEvent('click');}}})]:null,new Element('a.icon2.completed',{'text':'mark this movie done','events':{'click':self.markMovieDone.bind(self)}}))}},get:function(release,type){return release.info[type]!==undefined?release.info[type]:'n/a'},download:function(release){var self=this;var release_el=self.release_container.getElement('#release_'+release.id),icon=release_el.getElement('.download.icon2');if(icon)
icon.addClass('icon spinner').removeClass('download');Api.request('release.manual_download',{'data':{'id':release.id},'onComplete':function(json){if(icon)
icon.removeClass('icon spinner');if(json.success){if(icon)
icon.addClass('completed');release_el.getElement('.release_status').set('text','snatched');}
else
if(icon)
icon.addClass('attention').set('title','Something went wrong when downloading, please check logs.');}});},ignore:function(release){var self=this;Api.request('release.ignore',{'data':{'id':release.id},})},markMovieDone:function(){var self=this;Api.request('media.delete',{'data':{'id':self.movie.get('id'),'delete_from':'wanted'},'onComplete':function(){var movie=$(self.movie);movie.set('tween',{'duration':300,'onComplete':function(){self.movie.destroy()}});movie.tween('height',0);}});},tryNextRelease:function(){var self=this;Api.request('movie.searcher.try_next',{'data':{'id':self.movie.get('id')}});}});MA.Trailer=new Class({Extends:MovieAction,id:null,create:function(){var self=this;self.el=new Element('a.trailer',{'title':'Watch the trailer of '+self.getTitle(),'events':{'click':self.watch.bind(self)}});},watch:function(offset){var self=this;var data_url='https://gdata.youtube.com/feeds/videos?vq="{title}" {year} trailer&max-results=1&alt=json-in-script&orderby=relevance&sortorder=descending&format=5&fmt=18'
var url=data_url.substitute({'title':encodeURI(self.getTitle()),'year':self.get('year'),'offset':offset||1}),size=$(self.movie).getSize(),height=self.options.height||(size.x/16)*9,id='trailer-'+randomString();self.player_container=new Element('div[id='+id+']');self.container=new Element('div.hide.trailer_container').adopt(self.player_container).inject($(self.movie),'top');self.container.setStyle('height',0);self.container.removeClass('hide');self.close_button=new Element('a.hide.hide_trailer',{'text':'Hide trailer','events':{'click':self.stop.bind(self)}}).inject(self.movie);self.container.setStyle('height',height);$(self.movie).setStyle('height',height);new Request.JSONP({'url':url,'onComplete':function(json){var video_url=json.feed.entry[0].id.$t.split('/'),video_id=video_url[video_url.length-1];self.player=new YT.Player(id,{'height':height,'width':size.x,'videoId':video_id,'playerVars':{'autoplay':1,'showsearch':0,'wmode':'transparent','iv_load_policy':3}});self.close_button.removeClass('hide');var quality_set=false;var change_quality=function(state){if(!quality_set&&(state.data==1||state.data||2)){try{self.player.setPlaybackQuality('hd720');quality_set=true;}
catch(e){}}}
self.player.addEventListener('onStateChange',change_quality);}}).send()},stop:function(){var self=this;self.player.stopVideo();self.container.addClass('hide');self.close_button.addClass('hide');$(self.movie).setStyle('height',null);setTimeout(function(){self.container.destroy()
self.close_button.destroy();},1800)}});MA.Edit=new Class({Extends:MovieAction,create:function(){var self=this;self.el=new Element('a.edit',{'title':'Change movie information, like title and quality.','events':{'click':self.editMovie.bind(self)}});},editMovie:function(e){var self=this;(e).preventDefault();if(!self.options_container){self.options_container=new Element('div.options').adopt(new Element('div.form').adopt(self.title_select=new Element('select',{'name':'title'}),self.profile_select=new Element('select',{'name':'profile'}),self.category_select=new Element('select',{'name':'category'}).grab(new Element('option',{'value':-1,'text':'None'})),new Element('a.button.edit',{'text':'Save & Search','events':{'click':self.save.bind(self)}}))).inject(self.movie,'top');Array.each(self.movie.data.library.titles,function(alt){new Element('option',{'text':alt.title}).inject(self.title_select);if(alt['default'])
self.title_select.set('value',alt.title);});var categories=CategoryList.getAll();if(categories.length==0)
self.category_select.hide();else{self.category_select.show();categories.each(function(category){var category_id=category.data.id;new Element('option',{'value':category_id,'text':category.data.label}).inject(self.category_select);if(self.movie.category&&self.movie.category.data&&self.movie.category.data.id==category_id)
self.category_select.set('value',category_id);});}
var profiles=Quality.getActiveProfiles();if(profiles.length==1)
self.profile_select.hide();profiles.each(function(profile){var profile_id=profile.id?profile.id:profile.data.id;new Element('option',{'value':profile_id,'text':profile.label?profile.label:profile.data.label}).inject(self.profile_select);if(self.movie.get('profile_id')==profile_id)
self.profile_select.set('value',profile_id);});}
self.movie.slide('in',self.options_container);},save:function(e){(e).preventDefault();var self=this;Api.request('movie.edit',{'data':{'id':self.movie.get('id'),'default_title':self.title_select.get('value'),'profile_id':self.profile_select.get('value'),'category_id':self.category_select.get('value')},'useSpinner':true,'spinnerTarget':$(self.movie),'onComplete':function(){self.movie.quality.set('text',self.profile_select.getSelected()[0].get('text'));self.movie.title.set('text',self.title_select.getSelected()[0].get('text'));}});self.movie.slide('out');}})
MA.Refresh=new Class({Extends:MovieAction,create:function(){var self=this;self.el=new Element('a.refresh',{'title':'Refresh the movie info and do a forced search','events':{'click':self.doRefresh.bind(self)}});},doRefresh:function(e){var self=this;(e).preventDefault();Api.request('media.refresh',{'data':{'id':self.movie.get('id')}});}});MA.Readd=new Class({Extends:MovieAction,create:function(){var self=this;var movie_done=Status.get(self.movie.data.status_id).identifier=='done';if(!movie_done)
var snatched=self.movie.data.releases.filter(function(release){return release.status&&(release.status.identifier=='snatched'||release.status.identifier=='downloaded'||release.status.identifier=='done');}).length;if(movie_done||snatched&&snatched>0)
self.el=new Element('a.readd',{'title':'Readd the movie and mark all previous snatched/downloaded as ignored','events':{'click':self.doReadd.bind(self)}});},doReadd:function(e){var self=this;(e).preventDefault();Api.request('movie.add',{'data':{'identifier':self.movie.get('identifier'),'ignore_previous':1}});}});MA.Delete=new Class({Extends:MovieAction,Implements:[Chain],create:function(){var self=this;self.el=new Element('a.delete',{'title':'Remove the movie from this CP list','events':{'click':self.showConfirm.bind(self)}});},showConfirm:function(e){var self=this;(e).preventDefault();if(!self.delete_container){self.delete_container=new Element('div.buttons.delete_container').adopt(new Element('a.cancel',{'text':'Cancel','events':{'click':self.hideConfirm.bind(self)}}),new Element('span.or',{'text':'or'}),new Element('a.button.delete',{'text':'Delete '+self.movie.title.get('text'),'events':{'click':self.del.bind(self)}})).inject(self.movie,'top');}
self.movie.slide('in',self.delete_container);},hideConfirm:function(e){var self=this;(e).preventDefault();self.movie.removeView();self.movie.slide('out');},del:function(e){(e).preventDefault();var self=this;var movie=$(self.movie);self.chain(function(){self.callChain();},function(){Api.request('media.delete',{'data':{'id':self.movie.get('id'),'delete_from':self.movie.list.options.identifier},'onComplete':function(){movie.set('tween',{'duration':300,'onComplete':function(){self.movie.destroy()}});movie.tween('height',0);}});});self.callChain();}});MA.Files=new Class({Extends:MovieAction,create:function(){var self=this;self.el=new Element('a.directory',{'title':'Available files','events':{'click':self.show.bind(self)}});},show:function(e){var self=this;(e).preventDefault();if(self.releases)
self.showFiles();else{self.movie.busy(true);Api.request('release.for_movie',{'data':{'id':self.movie.data.id},'onComplete':function(json){self.movie.busy(false,1);if(json&&json.releases){self.releases=json.releases;self.showFiles();}
else
alert('Something went wrong, check the logs.');}});}},showFiles:function(){var self=this;if(!self.options_container){self.options_container=new Element('div.options').adopt(self.files_container=new Element('div.files.table')).inject(self.movie,'top');new Element('div.item.head').adopt(new Element('span.name',{'text':'File'}),new Element('span.type',{'text':'Type'}),new Element('span.is_available',{'text':'Available'})).inject(self.files_container)
Array.each(self.releases,function(release){var rel=new Element('div.release').inject(self.files_container);Array.each(release.files,function(file){new Element('div.file.item').adopt(new Element('span.name',{'text':file.path}),new Element('span.type',{'text':File.Type.get(file.type_id).name}),new Element('span.available',{'text':file.available})).inject(rel)});});}
self.movie.slide('in',self.options_container);},});

// /root/.xbmc/addons/service.downloadmanager.InternetPVR/CouchPotatoServer/couchpotato/core/media/movie/_base/static/movie.js:1401248966
var Movie=new Class({Extends:BlockBase,action:{},initialize:function(list,options,data){var self=this;self.data=data;self.view=options.view||'details';self.list=list;self.el=new Element('div.movie');self.profile=Quality.getProfile(data.profile_id)||{};self.category=CategoryList.getCategory(data.category_id)||{};self.parent(self,options);self.addEvents();},addEvents:function(){var self=this;self.global_events={}
self.global_events['movie.update']=function(notification){if(self.data.id!=notification.data.id)return;self.busy(false);self.removeView();self.update.delay(2000,self,notification);}
App.on('movie.update',self.global_events['movie.update']);['media.busy','movie.searcher.started'].each(function(listener){self.global_events[listener]=function(notification){if(notification.data&&(self.data.id==notification.data.id||(typeOf(notification.data.id)=='array'&&notification.data.id.indexOf(self.data.id)>-1)))
self.busy(true);}
App.on(listener,self.global_events[listener]);})
self.global_events['movie.searcher.ended']=function(notification){if(notification.data&&self.data.id==notification.data.id)
self.busy(false)}
App.on('movie.searcher.ended',self.global_events['movie.searcher.ended']);self.global_events['release.update_status']=function(notification){var data=notification.data
if(data&&self.data.id==data.movie_id){if(!self.data.releases)
self.data.releases=[];self.data.releases.push({'quality_id':data.quality_id,'status_id':data.status_id});self.updateReleases();}}
App.on('release.update_status',self.global_events['release.update_status']);},destroy:function(){var self=this;self.el.destroy();delete self.list.movies_added[self.get('id')];self.list.movies.erase(self)
self.list.checkIfEmpty();Object.each(self.global_events,function(handle,listener){App.off(listener,handle);});},busy:function(set_busy,timeout){var self=this;if(!set_busy){setTimeout(function(){if(self.spinner){self.mask.fade('out');setTimeout(function(){if(self.mask)
self.mask.destroy();if(self.spinner)
self.spinner.el.destroy();self.spinner=null;self.mask=null;},timeout||400);}},timeout||1000)}
else if(!self.spinner){self.createMask();self.spinner=createSpinner(self.mask);self.mask.fade('in');}},createMask:function(){var self=this;self.mask=new Element('div.mask',{'styles':{'z-index':4}}).inject(self.el,'top').fade('hide');},positionMask:function(){var self=this,s=self.el.getSize()
return self.mask.setStyles({'width':s.x,'height':s.y}).position({'relativeTo':self.el})},update:function(notification){var self=this;self.data=notification.data;self.el.empty();self.removeView();self.profile=Quality.getProfile(self.data.profile_id)||{};self.category=CategoryList.getCategory(self.data.category_id)||{};self.create();self.busy(false);},create:function(){var self=this;var s=Status.get(self.get('status_id'));self.el.addClass('status_'+s.identifier);self.el.adopt(self.select_checkbox=new Element('input[type=checkbox].inlay',{'events':{'change':function(){self.fireEvent('select')}}}),self.thumbnail=File.Select.single('poster',self.data.library.files),self.data_container=new Element('div.data.inlay.light').adopt(self.info_container=new Element('div.info').adopt(new Element('div.title').adopt(self.title=new Element('span',{'text':self.getTitle()||'n/a'}),self.year=new Element('div.year',{'text':self.data.library.year||'n/a'})),self.description=new Element('div.description',{'text':self.data.library.plot}),self.quality=new Element('div.quality',{'events':{'click':function(e){var releases=self.el.getElement('.actions .releases');if(releases.isVisible())
releases.fireEvent('click',[e])}}})),self.actions=new Element('div.actions')));if(self.thumbnail.empty)
self.el.addClass('no_thumbnail');self.select_checkbox_class=new Form.Check(self.select_checkbox);if(self.profile.data)
self.profile.getTypes().each(function(type){var q=self.addQuality(type.quality_id||type.get('quality_id'));if((type.finish==true||type.get('finish'))&&!q.hasClass('finish')){q.addClass('finish');q.set('title',q.get('title')+' Will finish searching for this movie if this quality is found.')}});self.updateReleases();Object.each(self.options.actions,function(action,key){self.action[key.toLowerCase()]=action=new self.options.actions[key](self)
if(action.el)
self.actions.adopt(action)});},updateReleases:function(){var self=this;if(!self.data.releases||self.data.releases.length==0)return;self.data.releases.each(function(release){var q=self.quality.getElement('.q_id'+release.quality_id),status=Status.get(release.status_id);if(!q&&(status.identifier=='snatched'||status.identifier=='seeding'||status.identifier=='done'))
var q=self.addQuality(release.quality_id)
if(status&&q&&!q.hasClass(status.identifier)){q.addClass(status.identifier);q.set('title',(q.get('title')?q.get('title'):'')+' status: '+status.label)}});},addQuality:function(quality_id){var self=this;var q=Quality.getQuality(quality_id);return new Element('span',{'text':q.label,'class':'q_'+q.identifier+' q_id'+q.id,'title':''}).inject(self.quality);},getTitle:function(){var self=this;var titles=self.data.library.titles;var title=titles.filter(function(title){return title['default']}).pop()
if(title)
return self.getUnprefixedTitle(title.title)
else if(titles.length>0)
return self.getUnprefixedTitle(titles[0].title)
return'Unknown movie'},getUnprefixedTitle:function(t){if(t.substr(0,4).toLowerCase()=='the ')
t=t.substr(4)+', The';return t;},slide:function(direction,el){var self=this;if(direction=='in'){self.temp_view=self.view;self.changeView('details');self.el.addEvent('outerClick',function(){self.removeView();self.slide('out')})
el.show();self.data_container.addClass('hide_right');}
else{self.el.removeEvents('outerClick')
setTimeout(function(){if(self.el)
self.el.getElements('> :not(.data):not(.poster):not(.movie_container)').hide();},600);self.data_container.removeClass('hide_right');}},changeView:function(new_view){var self=this;if(self.el)
self.el.removeClass(self.view+'_view').addClass(new_view+'_view')
self.view=new_view;},removeView:function(){var self=this;self.el.removeClass(self.view+'_view')},get:function(attr){return this.data[attr]||this.data.library[attr]},select:function(bool){var self=this;self.select_checkbox_class[bool?'check':'uncheck']()},isSelected:function(){return this.select_checkbox.get('checked');},toElement:function(){return this.el;}});

// /root/.xbmc/addons/service.downloadmanager.InternetPVR/CouchPotatoServer/couchpotato/core/media/movie/_base/static/search.js:1401248966
Block.Search.MovieItem=new Class({Implements:[Options,Events],initialize:function(info,options){var self=this;self.setOptions(options);self.info=info;self.alternative_titles=[];self.create();},create:function(){var self=this,info=self.info;self.el=new Element('div.media_result',{'id':info.imdb}).adopt(self.thumbnail=info.images&&info.images.poster.length>0?new Element('img.thumbnail',{'src':info.images.poster[0],'height':null,'width':null}):null,self.options_el=new Element('div.options.inlay'),self.data_container=new Element('div.data',{'events':{'click':self.showOptions.bind(self)}}).adopt(self.info_container=new Element('div.info').adopt(new Element('h2').adopt(self.title=new Element('span.title',{'text':info.titles&&info.titles.length>0?info.titles[0]:'Unknown'}),self.year=info.year?new Element('span.year',{'text':info.year}):null))))
if(info.titles)
info.titles.each(function(title){self.alternativeTitle({'title':title});})},alternativeTitle:function(alternative){var self=this;self.alternative_titles.include(alternative);},getTitle:function(){var self=this;try{return self.info.original_title?self.info.original_title:self.info.titles[0];}
catch(e){return'Unknown';}},get:function(key){return this.info[key]},showOptions:function(){var self=this;self.createOptions();self.data_container.addClass('open');self.el.addEvent('outerClick',self.closeOptions.bind(self))},closeOptions:function(){var self=this;self.data_container.removeClass('open');self.el.removeEvents('outerClick')},add:function(e){var self=this;if(e)
(e).preventDefault();self.loadingMask();Api.request('movie.add',{'data':{'identifier':self.info.imdb,'title':self.title_select.get('value'),'profile_id':self.profile_select.get('value'),'category_id':self.category_select.get('value')},'onComplete':function(json){self.options_el.empty();self.options_el.adopt(new Element('div.message',{'text':json.success?'Movie successfully added.':'Movie didn\'t add properly. Check logs'}));self.mask.fade('out');self.fireEvent('added');},'onFailure':function(){self.options_el.empty();self.options_el.adopt(new Element('div.message',{'text':'Something went wrong, check the logs for more info.'}));self.mask.fade('out');}});},createOptions:function(){var self=this,info=self.info;if(!self.options_el.hasClass('set')){if(self.info.in_library){var in_library=[];self.info.in_library.releases.each(function(release){in_library.include(release.quality.label)});}
self.options_el.grab(new Element('div',{'class':self.info.in_wanted&&self.info.in_wanted.profile_id||in_library?'in_library_wanted':''}).adopt(self.info.in_wanted&&self.info.in_wanted.profile_id?new Element('span.in_wanted',{'text':'Already in wanted list: '+Quality.getProfile(self.info.in_wanted.profile_id).get('label')}):(in_library?new Element('span.in_library',{'text':'Already in library: '+in_library.join(', ')}):null),self.title_select=new Element('select',{'name':'title'}),self.profile_select=new Element('select',{'name':'profile'}),self.category_select=new Element('select',{'name':'category'}).grab(new Element('option',{'value':-1,'text':'None'})),self.add_button=new Element('a.button',{'text':'Add','events':{'click':self.add.bind(self)}})));Array.each(self.alternative_titles,function(alt){new Element('option',{'text':alt.title}).inject(self.title_select)})
var categories=CategoryList.getAll();if(categories.length==0)
self.category_select.hide();else{self.category_select.show();categories.each(function(category){new Element('option',{'value':category.data.id,'text':category.data.label}).inject(self.category_select);});}
var profiles=Quality.getActiveProfiles();if(profiles.length==1)
self.profile_select.hide();profiles.each(function(profile){new Element('option',{'value':profile.id?profile.id:profile.data.id,'text':profile.label?profile.label:profile.data.label}).inject(self.profile_select)});self.options_el.addClass('set');if(categories.length==0&&self.title_select.getElements('option').length==1&&profiles.length==1&&!(self.info.in_wanted&&self.info.in_wanted.profile_id||in_library))
self.add();}},loadingMask:function(){var self=this;self.mask=new Element('div.mask').inject(self.el).fade('hide')
createSpinner(self.mask)
self.mask.fade('in')},toElement:function(){return this.el}});

// /root/.xbmc/addons/service.downloadmanager.InternetPVR/CouchPotatoServer/couchpotato/core/media/movie/suggestion/static/suggest.js:1401248966
var SuggestList=new Class({Implements:[Options,Events],initialize:function(options){var self=this;self.setOptions(options);self.create();},create:function(){var self=this;self.el=new Element('div.suggestions',{'events':{'click:relay(a.delete)':function(e,el){(e).stop();$(el).getParent('.media_result').destroy();Api.request('suggestion.ignore',{'data':{'imdb':el.get('data-ignore')},'onComplete':self.fill.bind(self)});},'click:relay(a.eye-open)':function(e,el){(e).stop();$(el).getParent('.media_result').destroy();Api.request('suggestion.ignore',{'data':{'imdb':el.get('data-seen'),'mark_seen':1},'onComplete':self.fill.bind(self)});}}}).grab(new Element('h2',{'text':'You might like these'}));self.api_request=Api.request('suggestion.view',{'onComplete':self.fill.bind(self)});},fill:function(json){var self=this;if(!json||json.count==0){self.el.hide();}
else{Object.each(json.suggestions,function(movie){var m=new Block.Search.MovieItem(movie,{'onAdded':function(){self.afterAdded(m,movie)}});m.data_container.grab(new Element('div.actions').adopt(new Element('a.add.icon2',{'title':'Add movie with your default quality','data-add':movie.imdb,'events':{'click':m.showOptions.bind(m)}}),$(new MA.IMDB(m)),$(new MA.Trailer(m,{'height':150})),new Element('a.delete.icon2',{'title':'Don\'t suggest this movie again','data-ignore':movie.imdb}),new Element('a.eye-open.icon2',{'title':'Seen it, like it, don\'t add','data-seen':movie.imdb})));m.data_container.removeEvents('click');var plot=false;if(m.info.plot&&m.info.plot.length>0)
plot=m.info.plot;m.info_container.adopt(m.rating=m.info.rating&&m.info.rating.imdb&&m.info.rating.imdb.length==2&&parseFloat(m.info.rating.imdb[0])>0?new Element('span.rating',{'text':parseFloat(m.info.rating.imdb[0]),'title':parseInt(m.info.rating.imdb[1])+' votes'}):null,m.genre=m.info.genres&&m.info.genres.length>0?new Element('span.genres',{'text':m.info.genres.slice(0,3).join(', ')}):null,m.plot=plot?new Element('span.plot',{'text':plot,'events':{'click':function(){this.toggleClass('full')}}}):null)
$(m).inject(self.el);});}
self.fireEvent('loaded');},afterAdded:function(m,movie){var self=this;setTimeout(function(){$(m).destroy();Api.request('suggestion.ignore',{'data':{'imdb':movie.imdb,'remove_only':true},'onComplete':self.fill.bind(self)});},3000);},toElement:function(){return this.el;}})